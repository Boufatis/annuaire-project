package com.insta.annuaire.dao;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;







import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class DAOExploitation extends DAO {
	
	private String[] uneExploitation;
	private String URL;
	ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
	
	public DAOExploitation()
	{
		super("",new ArrayList<NameValuePair>());
	}
	public String[] DAOgetExploitationById(String Param){

		this.URL = "http://www.projet-ppe.fr/pnr/android/getExploitationById.php";
		nameValuePairs.add(new BasicNameValuePair("Exploitation_Id",Param));
		super.setParametre(this.nameValuePairs);
		super.setURL(URL);
		try
		{		
				JSONArray jArray= new JSONArray(super.readResult());
				JSONObject json_data= jArray.getJSONObject(0);
				this.uneExploitation= new String[]{
					json_data.getString("Exploitation_Id"),
					json_data.getString("Exploitation_Nom"),
					json_data.getString("Exploitation_Details"),
					json_data.getString("Exploitation_Adresse"),
					json_data.getString("Exploitation_Adresse_Complement"),
					json_data.getString("Exploitation_Cp"),
					json_data.getString("Exploitation_Uth"),
					json_data.getString("Exploitation_Telephone"),
					json_data.getString("Exploitation_Latitude"),
					json_data.getString("Exploitation_Longitude"),
					json_data.getString("Exploitation_Juridique_Statut"),
					json_data.getString("Exploitation_Juridique_Date"),
					json_data.getString("Exploitation_Juridique_Ancien_Statut")};			
			
		}catch(JSONException e)
		{
		}
		return uneExploitation;
	}
	
	
	public  List<HashMap<String, String>> getListeExploitationSearch(String Exploitation_Nom){
		this.URL = "http://www.projet-ppe.fr/pnr/android/getListeExploitationSearch.php";
		nameValuePairs.add(new BasicNameValuePair("Exploitation_Nom",Exploitation_Nom));
		super.setParametre(this.nameValuePairs);
		super.setURL(URL);
	        // prepare the list of all records
	        List<HashMap<String, String>> lesExploitations = new ArrayList<HashMap<String, String>>();
	        JSONArray jArray;
			try {
				jArray = new JSONArray(super.readResult());
				for(int i = 0; i < jArray.length(); i++){
		        	JSONObject json_data = jArray.getJSONObject(i);
					HashMap<String, String> map = new HashMap<String, String>();
		            map.put("ID", "" + json_data.getString("Exploitation_Id"));
		            map.put("Nom", json_data.getString("Exploitation_Nom"));
		            map.put("Ville", json_data.getString("Exploitation_Ville"));
		            if(map!=null)
		            {
		            	lesExploitations.add(map);
		            }	            
		        }
			} catch (JSONException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}	
	        
	        return lesExploitations;
	}
	
	
	public  List<HashMap<String, String>> getListeExploitation(){
		this.URL = "http://www.projet-ppe.fr/pnr/android/getListeExploitation.php";
		super.setParametre(this.nameValuePairs);
		super.setURL(URL);
	        // prepare the list of all records
	        List<HashMap<String, String>> lesExploitations = new ArrayList<HashMap<String, String>>();
	        JSONArray jArray;
			try {
				jArray = new JSONArray(super.readResult());
				for(int i = 0; i < jArray.length(); i++){
		        	JSONObject json_data = jArray.getJSONObject(i);
					HashMap<String, String> map = new HashMap<String, String>();
		            map.put("ID", "" + json_data.getString("Exploitation_Id"));
		            map.put("Nom", json_data.getString("Exploitation_Nom"));
		            map.put("Ville", json_data.getString("Exploitation_Ville"));
		            if(map!=null)
		            {
		            	lesExploitations.add(map);
		            }
		            
		            
		        }
			} catch (JSONException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}	
	        
	        return lesExploitations;
	}
}
